<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏</title>

    <script src="https://cdn.jsdelivr.net/npm/jest-lite@1.0.0-alpha.4/dist/jest-lite.umd.js"></script>

    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        h1, h2 { color: #333; border-bottom: 2px solid #ccc; padding-bottom: 5px; }
        #results { margin-top: 20px; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
        .test-result-group { margin-bottom: 15px; padding: 10px; border: 1px solid #eee; border-radius: 4px; }
        .test-result.passed { color: green; }
        .test-result.failed { color: red; font-weight: bold; }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ç–µ—Å—Ç–∞–º–∏ –∏ –æ—Ç–ª–∞–¥–∫–æ–π</h1>

    <div id="results-container">
        <h2>–ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã Jest</h2>
        <div id="results"></div>
    </div>

    <hr>

    <div id="demo-container">
        <h2>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π (—Å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∑–∞–¥–∞—á–µ–π)</h2>
        <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –≤–∫–ª—é—á–∞—è <code>findMaxBroken</code>, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫—É.</p>
        <button onclick="runDemo()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é</button>
        <pre id="output"></pre>
    </div>


    <script>
        // ===================================================
        // 1. –§—É–Ω–∫—Ü–∏–∏ (–í–∞—à –∫–æ–¥ –∏–∑ script.js)
        // ===================================================

        function factorial(n) {
            if (n < 0) return null;
            let result = 1;

            for (let i = 1; i <= n; i++) {
                result *= i;
            }

            return result;
        }

        function findMax(arr) {
            // –ü—Ä–æ—Å—Ç–∞—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
            return Math.max(...arr);
        }

        // --- –ó–∞–¥–∞–Ω–∏–µ DevTools: –§—É–Ω–∫—Ü–∏—è —Å –æ—à–∏–±–∫–æ–π (–∑–∞—Ä–∞–Ω–µ–µ "—Å–ª–æ–º–∞–Ω–Ω–∞—è") ---
        function findMaxBroken(arr) {
            // !!! –û–®–ò–ë–ö–ê –ó–î–ï–°–¨ !!!
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è max = 0 —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–≤–µ—Ä–Ω–æ –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤,
            // —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Ç–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, [-5, -2, -9])
            let max = 0; // <-- –ò–°–•–û–î–ù–ê–Ø –û–®–ò–ë–ö–ê
            
            for (let i = 0; i < arr.length; i++) {
                if (arr[i] > max) {
                    max = arr[i];
                }
            }
            return max;
        }

        // --- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç findMaxBroken ---
        function findMaxFixed(arr) {
            // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
            let max = arr[0];
            for (let i = 1; i < arr.length; i++) {
                if (arr[i] > max) {
                    max = arr[i];
                }
            }
            return max;
        }

        function detectError(arr) {
            const broken = findMaxBroken(arr);
            const correct = findMaxFixed(arr);

            if (broken !== correct) {
                return "‚ö† –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ –≤ findMaxBroken():\n" +
                        "–§—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ " + broken + ", –Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî " + correct;
            }

            return "–û—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.";
        }


        function runDemo() {
            const out = document.getElementById("output");
            const fact = factorial(5);
            const testArray = [-5, -2, -9]; // –¢–µ—Å—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞

            const maxCorrect = findMax(testArray);
            const maxBroken = findMaxBroken(testArray);
            const maxFixed = findMaxFixed(testArray);
            const errorCheck = detectError(testArray);

            out.textContent =
                "factorial(5) = " + fact + "\n" +
                "–ú–∞—Å—Å–∏–≤: [" + testArray.join(", ") + "]\n\n" +
                "findMax (–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è) = " + maxCorrect + "\n" +
                "findMaxBroken (–° –æ—à–∏–±–∫–æ–π) = " + maxBroken + "\n" +
                "findMaxFixed (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è) = " + maxFixed + "\n\n" +
                "--- –ü—Ä–æ–≤–µ—Ä–∫–∞ findMaxBroken –Ω–∞ –æ—à–∏–±–∫—É ---\n" +
                errorCheck;
        }


        // ===================================================
        // 2. –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã Jest-Lite (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π)
        // ===================================================
        
        // –ü–æ–ª—É—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ Jest-Lite
        const { describe, test, expect, run } = jestLite;

        describe("–ü—Ä–æ–≤–µ—Ä–∫–∞ factorial()", () => {
            test("factorial(5) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 120", () => {
                expect(factorial(5)).toBe(120);
            });

            test("factorial(0) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1", () => {
                expect(factorial(0)).toBe(1);
            });
        });

        // –≠—Ç–æ—Ç —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ü–†–û–í–ê–õ–ò–¢–¨–°–Ø –∏–∑-–∑–∞ findMaxBroken
        describe("–ü—Ä–æ–≤–µ—Ä–∫–∞ findMaxBroken()", () => {
            test("–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ (–û–ñ–ò–î–ê–ï–ú –ü–†–û–í–ê–õ)", () => {
                // –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: -2, –Ω–æ findMaxBroken –≤–µ—Ä–Ω–µ—Ç 0 (–æ—à–∏–±–∫–∞!)
                expect(findMaxBroken([-5, -2, -9])).toBe(-2); // <-- –≠—Ç–æ—Ç —Ç–µ—Å—Ç –ü–†–û–í–ê–õ–ò–¢–°–Ø
            });
        });
        
        // –≠—Ç–æ—Ç —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ü–†–û–ô–¢–ò (–∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é)
        describe("–ü—Ä–æ–≤–µ—Ä–∫–∞ findMaxFixed()", () => {
            test("–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏", () => {
                expect(findMaxFixed([-5, -2, -9])).toBe(-2); // <-- –≠—Ç–æ—Ç —Ç–µ—Å—Ç –ü–†–û–ô–î–ï–¢
            });
        });

        // –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤, –∫–æ–≥–¥–∞ DOM –≥–æ—Ç–æ–≤
        window.onload = function() {
            run({ domElement: document.getElementById("results") });
        };
    </script>

</body>
</html>